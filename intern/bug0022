$Bug: Including of SetValue fails.$
$Category: OCL$
$State: Closed$
$BugAuthor: gogolla$
$Tests: test/t022$

hallo mark,

mir sind zwei use-fehler untergekommen. wie sollen wir mit so etwas
umgehen? hast du eine idee woran es liegt? dann koennte ich die
fehlerbehebung vieleicht an fabian gutsche geben.

gruss
martin

------------------------------------------------------------------------

Fehler 2:

model TC_TEST

class TC
operations
  transitiveClosure(init:Set(Sequence(OclAny))):Set(Sequence(OclAny))=
    let baseSet:Set(OclAny)=
      init->collect(at(1))->union(init->collect(at(2)))->asSet in
    baseSet->iterate(e1,e2,e3:OclAny;
      res:Set(Sequence(OclAny))=init |
      if res->exists(p1,p2:Sequence(OclAny) |
          p1->at(1)=e1 and p1->at(2)=e2 and
          p2->at(1)=e2 and p2->at(2)=e3)
        then res->including(Sequence{e1,e3}) else res endif)
  call_12_23():Set(Sequence(OclAny))=
    self.transitiveClosure(Set{Sequence{1,2},Sequence{2,3}})
end

!create tc:TC
?tc.call_12_23()
INTERNAL ERROR: An unexpected exception occured. This happened most probably
due to an error in the program. The program will try to continue, but may
not be able to recover from the error. Please send a bug report to mr@tzi.org
with a description of your last input and include the following output:
Program version: 2.1.0pre
Project version: use 0.217 Wed, 27 Jun 2001 23:38:19 +0200 mr
Stack trace: java.lang.IllegalArgumentException: type mismatch
        at org.tzi.use.uml.ocl.value.SetValue.including(SetValue.java:244)
        at org.tzi.use.uml.ocl.expr.Op_set_including.eval(ExpStdOp.java:1751)
        at org.tzi.use.uml.ocl.expr.ExpStdOp.eval(ExpStdOp.java:386)
        at org.tzi.use.uml.ocl.expr.ExpIf.eval(ExpIf.java:72)
        at org.tzi.use.uml.ocl.expr.ExpIterate.eval0(ExpIterate.java:145)
        at org.tzi.use.uml.ocl.expr.ExpIterate.eval0(ExpIterate.java:139)
        at org.tzi.use.uml.ocl.expr.ExpIterate.eval0(ExpIterate.java:139)
        at org.tzi.use.uml.ocl.expr.ExpIterate.eval(ExpIterate.java:115)
        at org.tzi.use.uml.ocl.expr.ExpLet.eval(ExpLet.java:66)
        at org.tzi.use.uml.ocl.expr.ExpObjOp.eval(ExpObjOp.java:110)
        at org.tzi.use.uml.ocl.expr.ExpObjOp.eval(ExpObjOp.java:110)
        at org.tzi.use.uml.ocl.expr.Evaluator.evaluate(Evaluator.java:111)
        at org.tzi.use.uml.ocl.expr.Evaluator.eval(Evaluator.java:69)
        at org.tzi.use.uml.ocl.expr.Evaluator.eval(Evaluator.java:80)
        at org.tzi.use.main.Shell.cmdQuery(Shell.java:762)
        at org.tzi.use.main.Shell.processLine(Shell.java:260)
        at org.tzi.use.main.Shell.processLineSafely(Shell.java:215)
        at org.tzi.use.main.Shell.run(Shell.java:174)
        at java.lang.Thread.run(Unknown Source)
